{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Game Server{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_head %}{% endblock %}
</head>
<body>

    {% if request.user.is_authenticated %}
        <div class="side-panel">
            <h3>
                {{ request.user.display_name|title }}
                <span><a class="button" href="{% url 'core:logout' %}{% block logout_next %}{% endblock %}">Logout</a></span>
            </h3>
            <div class="side-panel-content">
                <h4>Navigation</h4>
                {% if request.user.is_player %}
                    {% with request.user.players.first.session as session %}
                        <ul>
                            <li><a href="{% url 'core:session_portal' session.slug_name %}">Session portal</a></li>
                            <li><a href="{% url 'core:session_home' session.slug_name %}">Session home</a></li>
                        </ul>
                    {% endwith %}
                {% else %}
                    <ul>
                        <li><a href="{% url 'core:index' %}">Main page</a></li>
                        <li><a href="{% url 'core:create_session' %}">Create a session</a></li>
                    </ul>
                    {% if request.user.administrated_sessions.all %}
                        <h4>Sessions you administrate</h4>
                        <ul>
                            {% for session in request.user.administrated_sessions.all %}
                                <li>{{ session.name }}</li>
                                <ul>
                                    <li><a href="{% url "core:session_portal" session.slug_name %}">Portal</a></li>
                                    <li><a href="{% url "core:session_home" session.slug_name %}">Home page</a></li>
                                    <li><a href="{% url "core:session_admin" session.slug_name %}">Admin page</a></li>
                                </ul>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if request.user.players.all %}
                        <h4>Player profile</h4>
                        <ul>
                            {% for player in request.user.players.all %}
                                <li>
                                    {{ player.name }} for session <a href="{% url "core:session_portal" player.session.slug_name %}">{{ player.session.name }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    {% endif %}

    <header>
        {% block header %}{% endblock %}
    </header>

    {% if request.user.is_authenticated %}
        <main class="truncated-main">
    {% else %}
        <main class="full-main">
    {% endif %}
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>&copy; 2023 Simon Rey</p>
    </footer>

    {% block extra_scripts %}{% endblock %}
</body>
</html>