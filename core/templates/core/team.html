{% extends 'core/base_game.html' %}

{% block game_content %}
    <section>
        {% if created_team %}
            <p>
                Your team {{ created_team.name }} has now been registered. You can start playing for
                the team.
                {% with game.game_config.url_namespace|add:':index' as url_name %}
                    <a class="button navigation-button" href="{% url url_name session.url_tag game.url_tag %}">To the game</a>
                {% endwith %}
            </p>
        {% else %}
            {% if team_joined %}
                <p>
                    You have joined the team {{ joined_team.name }}. You can now play for the team.
                    {% with game.game_config.url_namespace|add:':index' as url_name %}
                        Go to the <a href="{% url url_name session.url_tag game.url_tag %}">game page</a>.
                    {% endwith %}
                </p>
            {% else %}
                {% if team %}
                    <p> You are already a member the team <em>{{ team.name }}</em>, this page is not for you!</p>
                {% else %}
                    <h2>Register a team</h2>

                    <p>
                        To register a team, just enter its name in the field below.
                        You will be automatically added to the team. Other players will then be able to join the team.
                    </p>

                    {% with 'core:'|add:game.game_config.url_tag|add:'_team' as url_name %}
                        <form action="{% url url_name session.url_tag game.url_tag %}" method="post">
                            {% include "include/form_table_template.html" with form=create_team_form form_type='create_team_form' submit_button_label='Create Team' %}
                        </form>
                    {% endwith %}

                    <h2>Join a team</h2>

                    {% if teams %}
                        <p>
                            If the team you want to be part of has already been created by another player, you can join
                            it here. Please do not join a team before having discussed it with its creator.
                        </p>

                        {% with 'core:'|add:game.game_config.url_tag|add:'_team' as url_name %}
                            <form action="{% url url_name session.url_tag game.url_tag %}" method="post">
                        {% endwith %}
                            {% csrf_token %}
                            {% for team in teams %}
                                <input type="radio" name="join_team_input" value="{{ team.id }}" id="join_team_{{ team.id }}">
                                <label for="join_team_{{ team.id }}">{{ team.name }} - created by {{ team.creator.name }}</label><br>
                            {% endfor %}

                            <p class="center-align">
                                <input class="green-button" type="submit" name="join_team_form" value="Join Team">
                            </p>
                        </form>
                    {% else %}
                        <p>No team has been created yet.</p>
                    {% endif %}
                {% endif %}
            {% endif %}
        {% endif %}
    </section>
{% endblock %}